(this["webpackJsonprouting-viewer"]=this["webpackJsonprouting-viewer"]||[]).push([[0],{27:function(e,t,a){e.exports=a(43)},32:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(8),i=a.n(o),c=(a(32),a(7)),l=a(16),s=a(17),u=a(23),d=a(18),p=a(6),m=a(24),f=a(3),h=(a(33),a(1)),g=a(25),y=a(5),v=a(4),b=a(10),E=a.n(b),O=a(19),N=a.n(O),w=a(20),j=a.n(w),k=a(21),C=a.n(k),R=a(22),_=a.n(R),S=a(26),x=a(12);function J(e,t){return e.toLowerCase().includes(t.toLowerCase())}function q(e){return Object.keys(e).sort().reduce((function(t,a){return t[a]=e[a],t}),{})}function F(e,t){return null==e?null==t?0:1:null==t?-1:function(e,t){if(e===t)return 0;if(e.length!==t.length)return e.length-t.length;for(var a=e.length,r=0;r<a;++r){var n=e[r].localeCompare(t[r]);if(0!==n)return n}return 0}(e.split(".",2),t.split(".",2))}function M(e){return function(t,a){for(var r=0;r<e.length;++r){var n=e[r](t,a);if(0!==n)return n}return 0}}var D=M([function(e,t){return F(null===e||void 0===e?void 0:e.request,null===t||void 0===t?void 0:t.request)},function(e,t){return F(null===e||void 0===e?void 0:e.group,null===t||void 0===t?void 0:t.group)},function(e,t){return F(null===e||void 0===e?void 0:e.source,null===t||void 0===t?void 0:t.source)},function(e,t){return F(null===e||void 0===e?void 0:e.destination,null===t||void 0===t?void 0:t.destination)},function(e,t){return F(null===e||void 0===e?void 0:e.application,null===t||void 0===t?void 0:t.application)}]),z=function(e,t){return D((null===e||void 0===e?void 0:e.left)||(null===e||void 0===e?void 0:e.right),(null===t||void 0===t?void 0:t.left)||(null===t||void 0===t?void 0:t.right))};function P(e){var t,a={};return(null===e||void 0===e?void 0:e.sourceFilters)&&(a.sourceFilters=q(e.sourceFilters)),(null===e||void 0===e?void 0:e.destinationFilters)&&(a.destinationFilters=q(e.destinationFilters)),a.rules=null===(t=e.rules)||void 0===t?void 0:t.sort(D),a}function L(e){try{return JSON.stringify(JSON.parse(e),null,4)}catch(t){console.error("Error in JSON formatting",t)}return e}function I(e,t){try{var a=JSON.parse(e),r=a.rules||[];return r.push(t),a.rules=r,JSON.stringify(a,null,4)}catch(n){console.error("Error in JSON formatting",n)}return e}function Q(e){try{var t=P(JSON.parse(e));return JSON.stringify(t,null,4)}catch(a){console.error("Error in JSON simplifying",a)}return e}function V(e,t,a){var r=[],n=[];return e.forEach((function(e){var o=!1;t.forEach((function(t){0===a(e,t)&&(r.push(t),o=!0)})),o||n.push({left:e,right:void 0})})),t.forEach((function(e){null!=r.find((function(t){return 0===a(e,t)}))||n.push({left:void 0,right:e})})),n}function T(e){var t=e||{};return Object.keys(t).map((function(e){return{name:e,body:t[e]}}))}var W=M([function(e,t){return F(null===e||void 0===e?void 0:e.name,null===t||void 0===t?void 0:t.name)}]);function U(e,t){var a,r;console.log("Converting the routing JSON to graph elements is started");var n="complex"==t.viewType,o=[],i=new Map,c=new Map,l=new Map;function s(e){var t=new Set;return e.forEach((function(e){e.requests.forEach((function(e){return t.add(e)}))})),t}function u(t){var a=i.get(t.id);if(null!=a)return a;if(i.set(t.id,t),!t.id.startsWith("adapter_"))return t;if(!n)return t;var r,o=(r=t.name,(e.sourceFilters||{})[r]||[]).length>0,c=function(t){return(e.destinationFilters||{})[t]||[]}(t.name).length>0;if(o||c){var l="root_"+t.id;u({id:l,name:t.name,parentId:t.id}),t.rootId=l}return t}var d=function(e){var t=c.get(e.source);null==t&&(t=new Map,c.set(e.source,t));var a=t.get(e.target),r=l.get(e.target)||0;null==a&&(a=[],t.set(e.target,a)),l.set(e.target,r+1),a.push(e)},p=function(e,t,a){var r=(a||{})[e]||[],n=[];return r.forEach((function(e){(e.requests.includes("*")||e.requests.includes(t))&&e.filters.forEach((function(e){return n.push(e)}))})),n},m=function(t,a,r){var n=u(t),o=u(a),i=n.rootId||n.id,c=o.rootId||o.id,l=i;if(n.rootId){var s=p(n.name,r,e.sourceFilters);p(n.name,r,e.destinationFilters);l=function(e,t,a,r){var o=t,i="block_outgoing_"+n.id;o.length>0&&u({id:i,name:"Outgoing Filters",parentId:n.id});var c=e,l=function(e){return e.findIndex((function(e){return e.toLowerCase().includes("requestRenaming".toLowerCase())}))}(o),s=l>=0;return o.forEach((function(e,t){var a="filter_outgoing_"+n.id+"_"+e+"_"+t;u({id:a,name:e,parentId:i}),d(!s||l>=t?{source:c,target:a,label:r}:{source:c,target:a,label:r,implicitLabel:!0}),c=a,++t})),c}(l,s,0,r)}if(o.rootId){p(o.name,r,e.sourceFilters);l=function(e,t,a,r){var n=a,i="block_incoming_"+o.id;n.length>0&&u({id:i,name:"Incoming Filters",parentId:o.id});var c=e;return n.forEach((function(e,t){var a="filter_incoming_"+o.id+"_"+e+"_"+t;u({id:a,name:e,parentId:i}),d({source:c,target:a,label:r}),c=a})),c}(l,0,p(o.name,r,e.destinationFilters),r)}d({source:l,target:c,label:r})};function f(e){return{id:"adapter_"+e,name:e}}function h(e){return{id:"application_"+e,name:e}}var g=new Set;null===(a=e.rules)||void 0===a||a.forEach((function(e){e.request&&g.add(e.request)})),Object.entries(e.sourceFilters||{}).forEach((function(e){var a=Object(x.a)(e,2),r=a[0],o=a[1],i=f(r);s(o).forEach((function(e){if(!g.has(e)){if(!J(r,t.searchQuery)&&!J(e,t.searchQuery))return;if("*"==e&&!n)return;var a="request_outgoing_"+i.id+"_"+e;m(i,{id:a,name:e},e)}}))})),Object.entries(e.destinationFilters||{}).forEach((function(e){var a=Object(x.a)(e,2),r=a[0],o=a[1],i=f(r);s(o).forEach((function(e){if(!g.has(e)){if(!J(r,t.searchQuery)&&!J(e,t.searchQuery))return;if("*"==e&&!n)return;var a="request_incoming_"+i.id+"_"+e;m({id:a,name:e},i,e)}}))})),null===(r=e.rules)||void 0===r||r.forEach((function(e){if(function(e,t){return!(!e.source||!J(e.source,t))||(!(!e.request||!J(e.request,t))||(!(!e.group||!J(e.group,t))||(!(!e.destination||!J(e.destination,t))||!(!e.application||!J(e.application,t)))))}(e,t.searchQuery)){var a=e.request||"";if(e.source&&e.destination&&m(f(e.source),f(e.destination),a),e.source&&e.application&&m(f(e.source),h(e.application),a),!e.source)if(e.destination){if(e.group){var r=f(e.destination);m({id:"group_"+e.group,name:e.group},r,a)}else if(e.request){var n=f(e.destination);m({id:"request_incoming_"+n.id+"_"+e.request,name:e.request},n,a)}}else if(e.application)if(e.group){var o=h(e.application);m({id:"group_"+e.group,name:e.group},o,a)}else if(e.request){var i=h(e.application);m({id:"request_incoming_"+i.id+"_"+e.request,name:e.request},i,a)}}}));return i.forEach((function(e){var t,a=(t=e.id,Math.min(10*(l.get(t)||1)+20,100)),r=[],i=e.name;e.id.startsWith("adapter_")?n&&e.rootId?(r=["block","block-adapter"],i=""):r=["node","node-adapter"]:e.id.startsWith("request_")?(r=["node-implicit","node-request"],i=""):e.id.startsWith("group_")?r=["node","node-implicit","node-group"]:e.id.startsWith("application_")?r=["node","node-application"]:e.id.startsWith("block_")?r=["block","block-filter-group"]:e.id.startsWith("filter_")?r=["node","node-filter"]:e.id.startsWith("root_adapter_")&&(r=["node","node-adapter"]),o.push({data:{id:e.id,label:i,parent:e.parentId},css:Object(S.a)({},{},{width:a,height:a}),classes:r})})),c.forEach((function(e,t){e.forEach((function(e){e.forEach((function(e){o.push({data:{source:e.source,target:e.target,label:e.label},classes:!0===e.implicitLabel?"implicit_label":void 0})}))}))})),console.log("Converting the routing JSON to graph elements is finished"),o}var A,B,$,G,H,K,X,Y,Z,ee,te,ae,re,ne,oe,ie,ce,le,se,ue=[{selector:"node",style:{label:"data(label)","font-size":"10px",color:"#ecf0f1","text-outline-color":"#34495e","text-outline-width":1,"text-valign":"center","text-halign":"center","border-width":0}},{selector:"edge",style:{label:"data(label)","text-rotation":"autorotate","line-color":"#bdc3c7",width:1,"font-size":"8px",color:"#34495e","arrow-scale":2,"mid-target-arrow-shape":"vee","target-arrow-shape":"vee","mid-target-arrow-color":"#2ecc71","target-arrow-color":"#2ecc71","target-distance-from-node":"5px","curve-style":"bezier"}},{selector:":parent",style:{"background-opacity":.1,"border-width":1}},{selector:".node",style:{}},{selector:".node-adapter",style:{"background-color":"#3498db","text-outline-color":"#2980b9"}},{selector:".node-filter",style:{"background-color":"#1abc9c","text-outline-color":"#16a085"}},{selector:".block",style:{"text-valign":"top","text-margin-y":"15px",padding:"20px"}},{selector:".block-adapter",style:{"background-color":"#3498db","border-color":"#2980b9","text-outline-color":"#2980b9"}},{selector:".block-filter-group",style:{"background-color":"#f1c40f","border-color":"#f39c12","text-outline-color":"#f39c12"}},{selector:".node-implicit",style:{"background-color":"#fff","border-style":"dashed","border-width":3}},{selector:".node-request",style:{"text-outline-color":"#d35400","border-color":"#e67e22"}},{selector:".node-group",style:{"text-outline-color":"#8e44ad","border-color":"#9b59b6"}},{selector:".node-application",style:{"background-color":"#e74c3c","text-outline-color":"#c0392b","border-color":"#c0392b"}},{selector:".implicit_label",style:{color:"#7f8c8d","text-opacity":.5}}];function de(e){return function(t,a,r){var n=e;t&&(n+="-"+t);var o=n;if(a)for(var i in a)if(a.hasOwnProperty(i)){var c=a[i];"boolean"==typeof c&&c?o+=" "+i:"string"==typeof c&&c&&(o+=" "+c)}return r&&(o+=" "+r),o}}E.a.use(N.a),E.a.use(j.a),E.a.use(C.a);var pe=de(""),me=de("column"),fe=(de("column"),A=h.f.bound,B=h.f.bound,$=h.f.bound,G=h.f.bound,H=h.f.bound,K=h.f.bound,X=h.f.bound,Y=h.f.bound,Z=h.f.bound,ee=h.f.bound,te=h.f.bound,Object(g.a)((re=function(e){function t(){var e,a;Object(l.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n))),Object(c.a)(a,"primaryRouting",ne,Object(p.a)(a)),Object(c.a)(a,"secondaryRouting",oe,Object(p.a)(a)),Object(c.a)(a,"searchQuery",ie,Object(p.a)(a)),Object(c.a)(a,"viewType",ce,Object(p.a)(a)),Object(c.a)(a,"difference",le,Object(p.a)(a)),Object(c.a)(a,"mode",se,Object(p.a)(a)),a.core=null,a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"onChangeSearchQuery",value:function(e){this.searchQuery=e.target.value}},{key:"onChangeViewType",value:function(e){var t=this;this.viewType=e.target.value,setTimeout((function(){t.updateLayout()}),500)}},{key:"onPrimaryRoutingChange",value:function(e){this.primaryRouting=e.target.value,this.autoUpdate()}},{key:"onSecondaryRoutingChange",value:function(e){this.secondaryRouting=e.target.value,this.autoUpdateDifference()}},{key:"formatJson",value:function(){this.primaryRouting=L(this.primaryRouting),this.secondaryRouting=L(this.secondaryRouting)}},{key:"simplifyJson",value:function(){this.primaryRouting=Q(this.primaryRouting),this.secondaryRouting=Q(this.secondaryRouting)}},{key:"updateDifference",value:function(){try{var e=JSON.parse(this.primaryRouting),t=JSON.parse(this.secondaryRouting);this.difference=function(e,t){return e=P(e),t=P(t),{sourceFilters:V(T(e.sourceFilters),T(t.sourceFilters),W),rules:V(e.rules||[],t.rules||[],D).sort(z),destinationFilters:[]}}(e,t)}catch(a){console.error("Error in JSON comparing",a)}}},{key:"updateLayout",value:function(){var e,t=null===(e=this.core)||void 0===e?void 0:e.layout({name:"cose-bilkent",idealEdgeLength:250,animate:"end",animationEasing:"ease-out",animationDuration:1e3,randomize:!0});null===t||void 0===t||t.run()}},{key:"changeMode",value:function(e){this.mode=e,this.autoUpdate()}},{key:"render",value:function(){var e=this,t=this.data;return n.a.createElement("div",{className:"app"},n.a.createElement("div",{className:"section"},n.a.createElement("h1",{className:"title"},"SOLAR Routing Viewer"),n.a.createElement("h2",{className:"subtitle"},'Copy the "routing.json" file into the text field to show routing graph')),n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"tabs is-toggle is-fullwidth is-toggle-rounded"},n.a.createElement("ul",null,n.a.createElement("li",{className:pe("",{"is-active":this.isComparatorMode})},n.a.createElement("a",{onClick:function(){return e.changeMode("comparator")}},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.h})),n.a.createElement("span",null,"Routing Comparator"))),n.a.createElement("li",{className:pe("",{"is-active":this.isVisualizerMode})},n.a.createElement("a",{onClick:function(){return e.changeMode("visualizer")}},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.d})),n.a.createElement("span",null,"Routing Visualizer"))))),n.a.createElement("div",{className:"columns"},n.a.createElement("div",{className:me("",{"is-one-third":this.isVisualizerMode})},n.a.createElement("div",{className:"card has-equal-height"},n.a.createElement("header",{className:"card-header"},n.a.createElement("p",{className:"card-header-title"},'Primary "routing.json"'),n.a.createElement("div",{className:"card-header-icon"},n.a.createElement("div",{className:"buttons"},n.a.createElement("button",{className:"button is-warning is-small",onClick:this.formatJson},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.f})),n.a.createElement("span",null,"Format")),n.a.createElement("button",{className:"button is-primary is-small",onClick:this.simplifyJson},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.e})),n.a.createElement("span",null,"Simplify"))))),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"content"},n.a.createElement("textarea",{className:"textarea",onChange:this.onPrimaryRoutingChange,value:this.primaryRouting,spellCheck:!1}))))),this.isComparatorMode&&n.a.createElement("div",{className:"column is-fullheight"},n.a.createElement("div",{className:"card has-equal-height"},n.a.createElement("header",{className:"card-header"},n.a.createElement("p",{className:"card-header-title"},'Secondary "routing.json"'),n.a.createElement("div",{className:"card-header-icon"},n.a.createElement("div",{className:"buttons"},n.a.createElement("button",{className:"button is-warning is-small",onClick:this.formatJson},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.c})),n.a.createElement("span",null,"Format")),n.a.createElement("button",{className:"button is-primary is-small",onClick:this.simplifyJson},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.e})),n.a.createElement("span",null,"Simplify"))))),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"content"},n.a.createElement("textarea",{className:"textarea",onChange:this.onSecondaryRoutingChange,value:this.secondaryRouting,spellCheck:!1}))))),this.isVisualizerMode&&n.a.createElement("div",{className:"column"},n.a.createElement("div",{className:"card has-equal-height"},n.a.createElement("header",{className:"card-header"},n.a.createElement("p",{className:"card-header-title"},"Visualization"),n.a.createElement("div",{className:"card-header-icon"},n.a.createElement("div",{className:"field has-addons"},n.a.createElement("div",{className:"control"},n.a.createElement("div",{className:"select is-small"},n.a.createElement("select",{onChange:this.onChangeViewType,value:this.viewType},n.a.createElement("option",{value:"simple"},"Simple"),n.a.createElement("option",{value:"complex"},"Complex")))),n.a.createElement("div",{className:"control"},n.a.createElement("input",{type:"text",className:"input is-small",placeholder:"Search query...",onChange:this.onChangeSearchQuery,value:this.searchQuery})),n.a.createElement("div",{className:"control"},n.a.createElement("button",{className:"button is-danger is-small",onClick:this.updateLayout},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.i})),n.a.createElement("span",null,"Refresh")))))),n.a.createElement("div",{className:"card-content"},n.a.createElement("div",{className:"content"},n.a.createElement(_.a,{elements:t,stylesheet:ue,className:"graph",cy:this.setCore}))))))),this.isComparatorMode&&n.a.createElement("div",{className:"section"},n.a.createElement("div",{className:"columns is-multiline"},n.a.createElement("div",{className:"column is-12"},n.a.createElement("div",{className:"card"},n.a.createElement("header",{className:"card-header"},n.a.createElement("span",{className:"card-header-icon"},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:v.g}))),n.a.createElement("p",{className:"card-header-title"},"Rules")),n.a.createElement("table",{className:"table is-hoverable is-fullwidth is-striped is-bordered"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"left"},"Left"),n.a.createElement("th",{className:"actions"}),n.a.createElement("th",{className:"right"},"Right"))),n.a.createElement("tbody",null,this.difference.rules.map((function(t){return n.a.createElement("tr",null,n.a.createElement("td",null,JSON.stringify(t.left)),n.a.createElement("td",{className:"actions"},n.a.createElement("button",{className:"button is-small is-primary",onClick:function(){return e.mergeRule(t)}},n.a.createElement("span",{className:"icon is-small"},n.a.createElement(y.a,{icon:null==t.left?v.a:v.b})))),n.a.createElement("td",null,JSON.stringify(t.right)))})))))))))}},{key:"autoUpdate",value:function(){this.autoUpdateLayout(),this.autoUpdateDifference()}},{key:"autoUpdateLayout",value:function(){var e=this;this.isVisualizerMode&&setTimeout((function(){e.updateLayout()}),500)}},{key:"autoUpdateDifference",value:function(){this.isComparatorMode&&this.updateDifference()}},{key:"mergeRule",value:function(e){e.left?this.secondaryRouting=I(this.secondaryRouting,e.left):e.right&&(this.primaryRouting=I(this.primaryRouting,e.right)),this.autoUpdate()}},{key:"setCore",value:function(e){this.core=e}},{key:"data",get:function(){try{return U(JSON.parse(this.primaryRouting),{searchQuery:this.searchQuery,viewType:this.viewType})}catch(e){return console.log("Routing conversion is failed",e),[]}}},{key:"isComparatorMode",get:function(){return"comparator"===this.mode}},{key:"isVisualizerMode",get:function(){return"visualizer"===this.mode}}]),t}(n.a.Component),ne=Object(f.a)(re.prototype,"primaryRouting",[h.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return'{"rules":[]}'}}),oe=Object(f.a)(re.prototype,"secondaryRouting",[h.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ie=Object(f.a)(re.prototype,"searchQuery",[h.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ce=Object(f.a)(re.prototype,"viewType",[h.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"simple"}}),le=Object(f.a)(re.prototype,"difference",[h.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{sourceFilters:[],rules:[],destinationFilters:[]}}}),se=Object(f.a)(re.prototype,"mode",[h.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"comparator"}}),Object(f.a)(re.prototype,"data",[h.g],Object.getOwnPropertyDescriptor(re.prototype,"data"),re.prototype),Object(f.a)(re.prototype,"onChangeSearchQuery",[A],Object.getOwnPropertyDescriptor(re.prototype,"onChangeSearchQuery"),re.prototype),Object(f.a)(re.prototype,"isComparatorMode",[h.g],Object.getOwnPropertyDescriptor(re.prototype,"isComparatorMode"),re.prototype),Object(f.a)(re.prototype,"isVisualizerMode",[h.g],Object.getOwnPropertyDescriptor(re.prototype,"isVisualizerMode"),re.prototype),Object(f.a)(re.prototype,"onChangeViewType",[B],Object.getOwnPropertyDescriptor(re.prototype,"onChangeViewType"),re.prototype),Object(f.a)(re.prototype,"onPrimaryRoutingChange",[$],Object.getOwnPropertyDescriptor(re.prototype,"onPrimaryRoutingChange"),re.prototype),Object(f.a)(re.prototype,"onSecondaryRoutingChange",[G],Object.getOwnPropertyDescriptor(re.prototype,"onSecondaryRoutingChange"),re.prototype),Object(f.a)(re.prototype,"formatJson",[H],Object.getOwnPropertyDescriptor(re.prototype,"formatJson"),re.prototype),Object(f.a)(re.prototype,"simplifyJson",[K],Object.getOwnPropertyDescriptor(re.prototype,"simplifyJson"),re.prototype),Object(f.a)(re.prototype,"updateDifference",[X],Object.getOwnPropertyDescriptor(re.prototype,"updateDifference"),re.prototype),Object(f.a)(re.prototype,"updateLayout",[Y],Object.getOwnPropertyDescriptor(re.prototype,"updateLayout"),re.prototype),Object(f.a)(re.prototype,"changeMode",[Z],Object.getOwnPropertyDescriptor(re.prototype,"changeMode"),re.prototype),Object(f.a)(re.prototype,"mergeRule",[ee],Object.getOwnPropertyDescriptor(re.prototype,"mergeRule"),re.prototype),Object(f.a)(re.prototype,"setCore",[te],Object.getOwnPropertyDescriptor(re.prototype,"setCore"),re.prototype),ae=re))||ae);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var he=document.getElementById("root");i.a.render(n.a.createElement(fe,null),he),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.42760a95.chunk.js.map