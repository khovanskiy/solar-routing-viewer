(this["webpackJsonprouting-viewer"]=this["webpackJsonprouting-viewer"]||[]).push([[0],{22:function(e,t,r){e.exports=r(40)},27:function(e,t,r){},40:function(e,t,r){"use strict";r.r(t);var o=r(0),a=r.n(o),n=r(3),i=r.n(n),c=(r(27),r(7)),l=r(11),s=r(12),u=r(18),d=r(13),p=r(4),f=r(19),g=r(2),h=(r(28),r(5)),m=r.n(h),b=r(14),y=r.n(b),v=r(15),w=r.n(v),O=r(16),E=r.n(O),_=r(17),j=r.n(_),k=r(20),C=r(1),x=r(21),N=r(8);function q(e,t){return e.toLowerCase().includes(t.toLowerCase())}function S(e,t){var r,o;console.log("Converting the routing JSON to graph elements is started");var a="complex"==t.viewType,n=[],i=new Map,c=new Map,l=new Map;function s(e){var t=new Set;return e.forEach((function(e){e.requests.forEach((function(e){return t.add(e)}))})),t}function u(t){var r=i.get(t.id);if(null!=r)return r;if(i.set(t.id,t),!t.id.startsWith("adapter_"))return t;if(!a)return t;var o,n=(o=t.name,(e.sourceFilters||{})[o]||[]).length>0,c=function(t){return(e.destinationFilters||{})[t]||[]}(t.name).length>0;if(n||c){var l="root_"+t.id;u({id:l,name:t.name,parentId:t.id}),t.rootId=l}return t}var d=function(e){var t=c.get(e.source);null==t&&(t=new Map,c.set(e.source,t));var r=t.get(e.target),o=l.get(e.target)||0;null==r&&(r=[],t.set(e.target,r)),l.set(e.target,o+1),r.push(e)},p=function(e,t,r){var o=(r||{})[e]||[],a=[];return o.forEach((function(e){(e.requests.includes("*")||e.requests.includes(t))&&e.filters.forEach((function(e){return a.push(e)}))})),a},f=function(t,r,o){var a=u(t),n=u(r),i=a.rootId||a.id,c=n.rootId||n.id,l=i;if(a.rootId){var s=p(a.name,o,e.sourceFilters);p(a.name,o,e.destinationFilters);l=function(e,t,r,o){var n=t,i="block_outgoing_"+a.id;n.length>0&&u({id:i,name:"Outgoing Filters",parentId:a.id});var c=e,l=function(e){return e.findIndex((function(e){return e.toLowerCase().includes("requestRenaming".toLowerCase())}))}(n),s=l>=0;return n.forEach((function(e,t){var r="filter_outgoing_"+a.id+"_"+e+"_"+t;u({id:r,name:e,parentId:i}),d(!s||l>=t?{source:c,target:r,label:o}:{source:c,target:r,label:o,implicitLabel:!0}),c=r,++t})),c}(l,s,0,o)}if(n.rootId){p(n.name,o,e.sourceFilters);l=function(e,t,r,o){var a=r,i="block_incoming_"+n.id;a.length>0&&u({id:i,name:"Incoming Filters",parentId:n.id});var c=e;return a.forEach((function(e,t){var r="filter_incoming_"+n.id+"_"+e+"_"+t;u({id:r,name:e,parentId:i}),d({source:c,target:r,label:o}),c=r})),c}(l,0,p(n.name,o,e.destinationFilters),o)}d({source:l,target:c,label:o})};function g(e){return{id:"adapter_"+e,name:e}}function h(e){return{id:"application_"+e,name:e}}var m=new Set;null===(r=e.rules)||void 0===r||r.forEach((function(e){e.request&&m.add(e.request)})),Object.entries(e.sourceFilters||{}).forEach((function(e){var r=Object(N.a)(e,2),o=r[0],n=r[1],i=g(o);s(n).forEach((function(e){if(!m.has(e)){if(!q(o,t.searchQuery)&&!q(e,t.searchQuery))return;if("*"==e&&!a)return;var r="request_outgoing_"+i.id+"_"+e;f(i,{id:r,name:e},e)}}))})),Object.entries(e.destinationFilters||{}).forEach((function(e){var r=Object(N.a)(e,2),o=r[0],n=r[1],i=g(o);s(n).forEach((function(e){if(!m.has(e)){if(!q(o,t.searchQuery)&&!q(e,t.searchQuery))return;if("*"==e&&!a)return;var r="request_incoming_"+i.id+"_"+e;f({id:r,name:e},i,e)}}))})),null===(o=e.rules)||void 0===o||o.forEach((function(e){if(function(e,t){return!(!e.source||!q(e.source,t))||(!(!e.request||!q(e.request,t))||(!(!e.group||!q(e.group,t))||(!(!e.destination||!q(e.destination,t))||!(!e.application||!q(e.application,t)))))}(e,t.searchQuery)){var r=e.request||"";if(e.source&&e.destination&&f(g(e.source),g(e.destination),r),e.source&&e.application&&f(g(e.source),h(e.application),r),!e.source)if(e.destination){if(e.group){var o=g(e.destination);f({id:"group_"+e.group,name:e.group},o,r)}else if(e.request){var a=g(e.destination);f({id:"request_incoming_"+a.id+"_"+e.request,name:e.request},a,r)}}else if(e.application)if(e.group){var n=h(e.application);f({id:"group_"+e.group,name:e.group},n,r)}else if(e.request){var i=h(e.application);f({id:"request_incoming_"+i.id+"_"+e.request,name:e.request},i,r)}}}));return i.forEach((function(e){var t,r=(t=e.id,Math.min(10*(l.get(t)||1)+20,100)),o=[],i=e.name;e.id.startsWith("adapter_")?a&&e.rootId?(o=["block","block-adapter"],i=""):o=["node","node-adapter"]:e.id.startsWith("request_")?(o=["node-implicit","node-request"],i=""):e.id.startsWith("group_")?o=["node","node-implicit","node-group"]:e.id.startsWith("application_")?o=["node","node-application"]:e.id.startsWith("block_")?o=["block","block-filter-group"]:e.id.startsWith("filter_")?o=["node","node-filter"]:e.id.startsWith("root_adapter_")&&(o=["node","node-adapter"]),n.push({data:{id:e.id,label:i,parent:e.parentId},css:Object(x.a)({},{},{width:r,height:r}),classes:o})})),c.forEach((function(e,t){e.forEach((function(e){e.forEach((function(e){n.push({data:{source:e.source,target:e.target,label:e.label},classes:!0===e.implicitLabel?"implicit_label":void 0})}))}))})),console.log("Converting the routing JSON to graph elements is finished"),n}var I,Q,L,J,T,F,W,D,z,P,M,V=[{selector:"node",style:{label:"data(label)","font-size":"10px",color:"#ecf0f1","text-outline-color":"#34495e","text-outline-width":1,"text-valign":"center","text-halign":"center","border-width":0}},{selector:"edge",style:{label:"data(label)","text-rotation":"autorotate","line-color":"#bdc3c7",width:1,"font-size":"8px",color:"#34495e","arrow-scale":2,"mid-target-arrow-shape":"vee","target-arrow-shape":"vee","mid-target-arrow-color":"#2ecc71","target-arrow-color":"#2ecc71","target-distance-from-node":"5px","curve-style":"bezier"}},{selector:":parent",style:{"background-opacity":.1,"border-width":1}},{selector:".node",style:{}},{selector:".node-adapter",style:{"background-color":"#3498db","text-outline-color":"#2980b9"}},{selector:".node-filter",style:{"background-color":"#1abc9c","text-outline-color":"#16a085"}},{selector:".block",style:{"text-valign":"top","text-margin-y":"15px",padding:"20px"}},{selector:".block-adapter",style:{"background-color":"#3498db","border-color":"#2980b9","text-outline-color":"#2980b9"}},{selector:".block-filter-group",style:{"background-color":"#f1c40f","border-color":"#f39c12","text-outline-color":"#f39c12"}},{selector:".node-implicit",style:{"background-color":"#fff","border-style":"dashed","border-width":3}},{selector:".node-request",style:{"text-outline-color":"#d35400","border-color":"#e67e22"}},{selector:".node-group",style:{"text-outline-color":"#8e44ad","border-color":"#9b59b6"}},{selector:".node-application",style:{"background-color":"#e74c3c","text-outline-color":"#c0392b","border-color":"#c0392b"}},{selector:".implicit_label",style:{color:"#7f8c8d","text-opacity":.5}}];m.a.use(y.a),m.a.use(w.a),m.a.use(E.a);var R=(I=C.f.bound,Q=C.f.bound,L=C.f.bound,J=C.f.bound,T=C.f.bound,F=C.f.bound,Object(k.a)((D=function(e){function t(){var e,r;Object(l.a)(this,t);for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return r=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a))),Object(c.a)(r,"routing",z,Object(p.a)(r)),Object(c.a)(r,"searchQuery",P,Object(p.a)(r)),Object(c.a)(r,"viewType",M,Object(p.a)(r)),r.core=null,r}return Object(f.a)(t,e),Object(s.a)(t,[{key:"onChangeSearchQuery",value:function(e){this.searchQuery=e.target.value}},{key:"onChangeViewType",value:function(e){var t=this;this.viewType=e.target.value,setTimeout((function(){t.formatLayout()}),500)}},{key:"onChange",value:function(e){var t=this;this.routing=e.target.value,setTimeout((function(){t.formatLayout()}),500)}},{key:"formatJson",value:function(){try{this.routing=JSON.stringify(JSON.parse(this.routing),null,4)}catch(e){console.error("Error in JSON formatting",e)}}},{key:"formatLayout",value:function(){var e,t=null===(e=this.core)||void 0===e?void 0:e.layout({name:"cose-bilkent",idealEdgeLength:250,animate:"end",animationEasing:"ease-out",animationDuration:1e3,randomize:!0});null===t||void 0===t||t.run()}},{key:"render",value:function(){var e=this.data;return a.a.createElement("div",{className:"app"},a.a.createElement("div",{className:"section"},a.a.createElement("h1",{className:"title"},"SOLAR Routing Viewer"),a.a.createElement("h2",{className:"subtitle"},'Copy the "routing.json" file into the text field to show routing graph')),a.a.createElement("div",{className:"section"},a.a.createElement("div",{className:"columns"},a.a.createElement("div",{className:"column"},a.a.createElement(j.a,{elements:e,stylesheet:V,className:"graph",cy:this.setCore})),a.a.createElement("div",{className:"column"},a.a.createElement("div",{className:"field is-grouped"},a.a.createElement("div",{className:"control"},a.a.createElement("button",{className:"button is-primary",onClick:this.formatJson},"Format JSON")),a.a.createElement("div",{className:"control"},a.a.createElement("button",{className:"button is-danger",onClick:this.formatLayout},"Format layout")),a.a.createElement("div",{className:"control"},a.a.createElement("input",{type:"text",className:"input",placeholder:"Search query...",onChange:this.onChangeSearchQuery,value:this.searchQuery})),a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"select"},a.a.createElement("select",{onChange:this.onChangeViewType,value:this.viewType},a.a.createElement("option",{value:"simple"},"Simple"),a.a.createElement("option",{value:"complex"},"Complex"))))),a.a.createElement("div",{className:"control is-fullheight"},a.a.createElement("textarea",{className:"textarea",onChange:this.onChange,value:this.routing}))))))}},{key:"setCore",value:function(e){this.core=e}},{key:"data",get:function(){try{return S(JSON.parse(this.routing),{searchQuery:this.searchQuery,viewType:this.viewType})}catch(e){return console.log("Routing conversion is failed",e),[]}}}]),t}(a.a.Component),z=Object(g.a)(D.prototype,"routing",[C.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return'{"rules":[]}'}}),P=Object(g.a)(D.prototype,"searchQuery",[C.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),M=Object(g.a)(D.prototype,"viewType",[C.n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"simple"}}),Object(g.a)(D.prototype,"data",[C.g],Object.getOwnPropertyDescriptor(D.prototype,"data"),D.prototype),Object(g.a)(D.prototype,"onChangeSearchQuery",[I],Object.getOwnPropertyDescriptor(D.prototype,"onChangeSearchQuery"),D.prototype),Object(g.a)(D.prototype,"onChangeViewType",[Q],Object.getOwnPropertyDescriptor(D.prototype,"onChangeViewType"),D.prototype),Object(g.a)(D.prototype,"onChange",[L],Object.getOwnPropertyDescriptor(D.prototype,"onChange"),D.prototype),Object(g.a)(D.prototype,"formatJson",[J],Object.getOwnPropertyDescriptor(D.prototype,"formatJson"),D.prototype),Object(g.a)(D.prototype,"formatLayout",[T],Object.getOwnPropertyDescriptor(D.prototype,"formatLayout"),D.prototype),Object(g.a)(D.prototype,"setCore",[F],Object.getOwnPropertyDescriptor(D.prototype,"setCore"),D.prototype),W=D))||W);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=document.getElementById("root");i.a.render(a.a.createElement(R,null),A),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.ec5c25a0.chunk.js.map